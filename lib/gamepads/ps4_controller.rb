module GamepadTester
  class PS4Controller < Gamepad
    def setup
      @options[:name] = "PS4 Controller"

      @border = [
        Point2D.new(7.6402595823641315, 13.450980392156863),
        Point2D.new(7.013326964204758, 13.450980392156863),
        Point2D.new(6.385027901372513, 13.450980392156863),
        Point2D.new(5.843559765584789, 13.70635571172258),
        Point2D.new(5.238109649215879, 13.847635089264513),
        Point2D.new(4.619896931000683, 13.764583487255921),
        Point2D.new(4.06095724403519, 13.517091980354461),
        Point2D.new(3.69677819215254, 13.994799035158568),
        Point2D.new(3.4882312340388877, 14.585942594127207),
        Point2D.new(3.295017920783447, 15.183146807213038),
        Point2D.new(3.0950404002851903, 15.777161892688154),
        Point2D.new(2.7838225947677318, 16.320734480057062),
        Point2D.new(2.3608269795513084, 16.776793310128006),
        Point2D.new(1.7831492427518065, 16.996484429034066),
        Point2D.new(1.1579824144682527, 17.028187564027075),
        Point2D.new(0.5625199770113365, 16.8493711493997),
        Point2D.new(0.07201917509131595, 16.467672899067402),
        Point2D.new(-0.24692193925757233, 15.934011962636314),
        Point2D.new(-0.35460234216954434, 15.324687405725573),
        Point2D.new(-0.32471787933708884, 14.698471583809374),
        Point2D.new(-0.2799664876650869, 14.071953791788268),
        Point2D.new(-0.20926973080918154, 13.44920441370349),
        Point2D.new(-0.10675961392564615, 12.830000731057869),
        Point2D.new(0.011303192000561957, 12.21345060496575),
        Point2D.new(0.12934573350183864, 11.597006304189645),
        Point2D.new(0.2727626462380477, 10.986165763768227),
        Point2D.new(0.41783146473264743, 10.375875682065288),
        Point2D.new(0.5629429287148453, 9.765406195040237),
        Point2D.new(0.7453313123430075, 9.16571667809372),
        Point2D.new(0.9707457752739884, 8.582456301332362),
        Point2D.new(1.318178225187462, 8.061937065782734),
        Point2D.new(1.6678449108662141, 7.563920781250449),
        Point2D.new(2.271897924928882, 7.414349863431145),
        Point2D.new(2.89859486504381, 7.398789559352511),
        Point2D.new(3.5243312578899464, 7.449701264356949),
        Point2D.new(4.131593260859351, 7.586357002018946),
        Point2D.new(4.758733524381845, 7.604080079773948),
        Point2D.new(5.330410733151423, 7.524313725490196),
        Point2D.new(5.95690985526014, 7.524313725490196),
        Point2D.new(6.5854004280823695, 7.524313725490196),
        Point2D.new(7.212518541326467, 7.524313725490196),
        Point2D.new(7.839832206461588, 7.524313725490196),
        Point2D.new(8.466943034720618, 7.524313725490195),
        Point2D.new(9.09412364638877, 7.524313725490196),
        Point2D.new(9.72201876342763, 7.524313725490196),
        Point2D.new(10.306226765864352, 7.63163955805281),
        Point2D.new(10.92113511109146, 7.595015692301358),
        Point2D.new(11.534003619025734, 7.495182219860601),
        Point2D.new(12.153729764903948, 7.414563527015237),
        Point2D.new(12.781173703471373, 7.4019700826557475),
        Point2D.new(13.400933352685444, 7.48108553677832),
        Point2D.new(13.832972243103551, 7.873184294373382),
        Point2D.new(14.19058714906192, 8.387923052803274),
        Point2D.new(14.461071515036208, 8.950082226077484),
        Point2D.new(14.665238909777182, 9.543013862696547),
        Point2D.new(14.810266533431328, 10.153130665660237),
        Point2D.new(14.95541804114264, 10.763768636543489),
        Point2D.new(15.10052624896675, 11.374224449103492),
        Point2D.new(15.226758970325001, 11.988981981225455),
        Point2D.new(15.3448767432925, 12.605819157383623),
        Point2D.new(15.457834107746198, 13.221836401282218),
        Point2D.new(15.544714462657291, 13.84378875568707),
        Point2D.new(15.589403630491912, 14.469435416336598),
        Point2D.new(15.62911069558895, 15.0958835555767),
        Point2D.new(15.602574133197333, 15.718459294049058),
        Point2D.new(15.352897202356301, 16.289949813683826),
        Point2D.new(14.910332926936167, 16.725521368074652),
        Point2D.new(14.348975419575233, 16.994300741325407),
        Point2D.new(13.72510363727562, 17.021402123434402),
        Point2D.new(13.1145621328487, 16.891154605969376),
        Point2D.new(12.626017008097925, 16.508552586798572),
        Point2D.new(12.279968406165176, 15.986195660356486),
        Point2D.new(12.056277953890929, 15.40028405380668),
        Point2D.new(11.863443460837507, 14.804250738402981),
        Point2D.new(11.671073617647055, 14.206080264705882),
        Point2D.new(11.403664257573142, 13.644840728161382),
        Point2D.new(10.86953008527069, 13.672743858043747),
        Point2D.new(10.27129283357747, 13.833362408332377),
        Point2D.new(9.65112416099877, 13.784525036959183),
        Point2D.new(9.11261333696133, 13.478757336961333),
        Point2D.new(8.497378709865192, 13.450980392156863),
        Point2D.new(7.869378470082722, 13.450980392156863),
        Point2D.new(7.6402595823641315, 13.450980392156863),
      ]

      # Correct for error from SVG export
      @border.each { |pt| pt.x += 0.35460234216954434; raise "X: #{pt.x}" if pt.x < 0 }
      @border.each { |pt| pt.y -= 7.398789559352511; raise "Y: #{pt.y}" if pt.y < 0 }

      @inputs = [
        Joystick.new(self, :left, x: 5.5, y: 5.5, radius: 0.75, button_id: "BUTTON_7"),
        Joystick.new(self, :right, x: 10.5, y: 5.5, radius: 0.75, button_id: "BUTTON_8"),

        Trigger.new(self, :left, x: 5.5, y: 7, height: 2.0),
        Trigger.new(self, :right, x: 9.5, y: 7, height: 2.0),

        DPad.new(self, nil, x: 3, y: 3, name: "D-Pad", width: 1.0, height: 0.7),

        # Bumpers
        Button.new(self, "BUTTON_9", x: 3, y: 0.2, name: "Left Bumper", width: 2.0, height: 0.25),
        Button.new(self, "BUTTON_10", x: 13, y: 0.2, name: "Right Bumper", width: 2.0, height: 0.25),

        # NAMED
        Button.new(self, "BUTTON_4", x: 5, y: 0.7, name: "Share", width: 0.5, height: 1.0),
        Button.new(self, "BUTTON_5", x: 8, y: 5.5, name: "Guide", hint: :round, radius: 0.25),
        Button.new(self, "BUTTON_6", x: 11, y: 0.7, name: "Options", width: 0.5, height: 1.0),

        # The 4
        Button.new(self, "BUTTON_0", x: 13, y: 4, name: "Cross", hint: :round, radius: 0.5, color: 0xff6b8aca),
        Button.new(self, "BUTTON_1", x: 14, y: 3, name: "Circle", hint: :round, radius: 0.5, color: 0xffcf5357),
        Button.new(self, "BUTTON_2", x: 12, y: 3, name: "Square", hint: :round, radius: 0.5, color: 0xffd98cc2),
        Button.new(self, "BUTTON_3", x: 13, y: 2, name: "Triangle", hint: :round, radius: 0.5, color: 0xff37d194),
      ]

      @label = Point2D.new(8, 4.8)
    end
  end
end